---
/**
 * EntryCard - Unified preview component for blog posts and apps
 *
 * Mathematically derived from the 'Ledger Entry' object category.
 * Handles conditional rendering of the 'app' tag based on collection type.
 */

import type { CollectionEntry } from "astro:content";
import FormattedDate from "./FormattedDate.astro";
import Link from "./Link.astro";
import { getReadingTime } from "../utils/content";

interface Props {
  entry: CollectionEntry<"blog"> | CollectionEntry<"apps">;
}

const { entry } = Astro.props;
const collection = entry.collection;
const url = `/${collection}/${entry.slug}/`;
const readingTime = collection === "blog" && entry.body ? getReadingTime(entry.body) : null;
---

<li class="post-item">
  <div class="post-date-group">
    <FormattedDate date={entry.data.date} className="post-date" variant="system" />
    {readingTime && <span class="post-reading-time">{readingTime}</span>}
  </div>
  <div class="post-content">
    <Link href={url} class="post-title">
      {entry.data.title}
    </Link>
    <p class="post-summary">{entry.data.summary}</p>
    <div class="post-tags">
      {collection === "apps" && (
        <Link href="/tags/app/" class="app-tag">app</Link>
      )}
      {entry.data.tags
        .filter((tag: string) => collection !== "apps" || tag !== "app")
        .map((tag: string) => (
          <Link href={`/tags/${tag}/`} variant="tag">{tag}</Link>
        ))
      }
    </div>
  </div>
</li>
