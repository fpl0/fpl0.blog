---
/**
 * PublishingIndicator - Spinning ring on ThemeToggle during deploys
 *
 * No HTML output — the ring SVG is injected dynamically by the
 * publishing utility module. This component owns the CSS and wires
 * up the lifecycle via onPageReady.
 */
---

<style is:global>
  /* Publishing indicator — spinning ring during deploy */
  .publishing-ring {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    color: var(--color-primary);
    opacity: 0;
    transition: opacity var(--duration-normal) var(--ease-out);
  }

  .publishing-ring circle {
    stroke-linecap: round;
    stroke-dasharray: 31.4 125.66;
  }

  .theme-toggle.is-publishing .publishing-ring {
    opacity: 1;
    animation: publishing-spin 1.2s linear infinite;
  }

  .theme-toggle.is-publishing {
    border-color: transparent;
  }

  @keyframes publishing-spin {
    to {
      transform: rotate(360deg);
    }
  }

  @media (max-width: 600px) {
    .publishing-ring {
      width: 40px;
      height: 40px;
    }

    .publishing-ring circle {
      r: 18;
      cx: 20;
      cy: 20;
      stroke-dasharray: 28.3 113.1;
    }
  }
</style>

<script>
  import { onPageReady } from "../utils/lifecycle";
  import { initPublishing } from "../utils/publishing";

  onPageReady(initPublishing);
</script>
